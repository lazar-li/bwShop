1 登陆上微博      

​	1.1微连接   里面  进入 ：网站接入

​	1.2  进入之后创建  等待 审核通过

​	1.3 最主要的是创建出来的 APP KEY :

​	1.4 应用信息里面  测试信息  我们添加测试 测试微博的账号之后保存！

​	1.5 应用信息高级设置 里面 授权设置 

​		1.5.1：授权回调页：http://127.0.0.1:8000/complete/weibo/

​			取消授权的回调页 ：http://127.0.0.1:8000/quitback/weibo/

​		什么是 `Aauth` 2.0 授权和回调   

​		注意一点要打开 那个网页 微博网站接口

​	1.6 下载 pip install social-auth-app-django

​		1.6.1 之后在 setting  注册项目的app 里面添加  `social_django`

​			在这个之后我们 migrate  迁移下数据库

​		1.6.2 setting

```
AUTHENTICATION_BACKENDS = (
    'users.views.CustomBackend',
    'social_core.backends.weibo.WeiboOAuth2',# 第三方登录-微博
    'social_core.backends.weixin.WeixinOAuth2',# 第三方登录-微信
    'social_core.backends.qq.QQOAuth2',# 第三方登录-QQ
    'django.contrib.auth.backends.ModelBackend'
)
之后在 settings 里面写入
	social_django
```

​	之后我们 需要 查看 前端  api。js  里面的 需要修改接口

​	修改成:http://127.0.0.01:8000/login/qq/

​			http://127.0.0.01:8000/login/weibo/

​			http://127.0.0.01:8000/login/weixin/



​	微博开发平台  <https://open.weibo.com/> 

​	我们需要下载的 库 

​		

​	pip install social-auth-app-django

```
python manage.py makemigrations
python manage.py migrate
```



如果用到模板的话需要在TEMPLATES下的OPTIONS下的context_processors添加   可有可无

```
'social_django.context_processors.backends',  # 回调
'social_django.context_processors.login_redirect',  # 重定向
```

setting。py 里面配置

```
#第三方登陆
SOCIAL_AUTH_WEIBO_KEY = '1548695208'  APP KEY
SOCIAL_AUTH_WEIBO_SECRET = '32bf161d899a2cef71d1b10a53188a5a'  APP SECRET
SOCIAL_AUTH_LOGIN_REDIRECT_URL = '/index/'   
```

​        url里的配置路由

```
path('',include('social_django.urls',namespace='social')),
```





​    venv Lib site -packages actions中添加

```
from rest_framework_jwt.serializers import jwt_payload_handler,jwt_encode_han
```

在文件里面的 倒数 第2个 def   需要注释 response  上面的那句话

```
response = backend.strategy.redirect(url)
payload = jwt_payload_handler(user)
response.set_cookie("name", user.name if user.name else user.username, max_age=24 * 3600)
response.set_cookie("token", jwt_encode_handler(payload), max_age=24 * 3600)
return response
```

在这之后需要讲 Vue npm run build  打包一个 dist 文件夹 放在项目下static    将dist下的index.html放到templates下 



​      settings配置

```
STATICFILES_DIRS = (
    os.path.join(BASE_DIR, "static"),
)
```